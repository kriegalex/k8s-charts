# QBittorrent Chart

![Version: 1.3.1](https://img.shields.io/badge/Version-1.3.1-informational?style=flat-square) ![Type: application](https://img.shields.io/badge/Type-application-informational?style=flat-square) ![AppVersion: legacy-4.3.9](https://img.shields.io/badge/AppVersion-legacy--4.3.9-informational?style=flat-square)

A Helm chart for deploying a QBittorrent client that uses a wireguard VPN tunnel.

## Important note

**By default, this chart uses the 4.3.9 version of qBittorrent, known to be stable.**

## Prerequisites
Before deploying this chart, ensure your Kubernetes cluster meets the following requirements:

1. Kubernetes 1.19+ – This chart uses features that are supported on Kubernetes 1.19 and above.
3. Helm 3.0+ – Helm 3 is required to manage and deploy this chart.
3. WireGuard Kernel Module – WireGuard must be available on all nodes in your cluster.

## Installation

### Allow unsafe sysctl

You need to allow two unsafe sysctl to be set by this chart. To do so, we must modify the existing kubelet configuration on the target worker nodes.

```console
cat <<EOF | sudo tee -a /var/lib/kubelet/config.yaml

# Add or update the following section:
allowedUnsafeSysctls:
  - "net.ipv4.conf.all.src_valid_mark"
  - "net.ipv6.conf.all.disable_ipv6"
EOF
```

Restart the kubelet service:

```console
sudo systemctl daemon-reload
sudo systemctl restart kubelet
```

### Helm

1. Add the Helm chart repo

```bash
helm repo add k8s-charts https://kriegalex.github.io/k8s-charts/
helm repo update
```

2. Inspect & modify the default values (optional)

```bash
helm show values k8s-charts/qbittorrent > custom-values.yaml
```

3. Install the chart

```bash
helm upgrade --install qbit k8s-charts/qbittorrent --values custom-values.yaml
```

## QBittorrent login

The login is `admin`. The password is visible in the logs of the qbittorent app the first time you start it:

```
kubectl logs qbit-qbittorrent-POD_NAME
```

Replace POD_NAME by the name of your pod (`kubectl get pods`).

## Port Forwarding

The port forwarding should be handled automatically by the docker image, if the correct environment variables have been set.

You can check it in the logs:

```console
kubectl logs qbit-qbittorrent-POD_NAME
```

Expected result:
```console
******** Information ********
To control qBittorrent, access the WebUI at: http://localhost:8080

[INF] [] [VPN] Forwarded port is [PORT].
[INF] [] [QBITTORRENT] Updated forwarded port to [PORT].
```

## Values

| Key | Type | Default | Description |
|-----|------|---------|-------------|
| affinity | object | `{}` |  |
| commonLabels | object | `{}` |  |
| env.PGID | int | `1000` |  |
| env.PRIVOXY_ENABLED | bool | `false` |  |
| env.PUID | int | `1000` |  |
| env.TZ | string | `"Etc/UTC"` |  |
| env.UMASK | int | `2` |  |
| env.UNBOUND_ENABLED | bool | `false` |  |
| env.VPN_AUTO_PORT_FORWARD | bool | `true` |  |
| env.VPN_AUTO_PORT_FORWARD_TO_PORTS | string | `""` |  |
| env.VPN_CONF | string | `"wg0"` |  |
| env.VPN_EXPOSE_PORTS_ON_LAN | string | `""` |  |
| env.VPN_FIREWALL_TYPE | string | `"auto"` |  |
| env.VPN_HEALTHCHECK_ENABLED | bool | `true` |  |
| env.VPN_KEEP_LOCAL_DNS | bool | `false` |  |
| env.VPN_LAN_LEAK_ENABLED | bool | `false` |  |
| env.VPN_LAN_NETWORK | string | `"192.168.1.0/24"` |  |
| env.VPN_PIA_DIP_TOKEN | string | `"no"` |  |
| env.VPN_PIA_PASS | string | `""` |  |
| env.VPN_PIA_PORT_FORWARD_PERSIST | bool | `false` |  |
| env.VPN_PIA_PREFERRED_REGION | string | `""` |  |
| env.VPN_PIA_USER | string | `""` |  |
| env.WEBUI_PORTS | string | `"8080/tcp,8080/udp"` |  |
| extraEnv | list | `[]` |  |
| fullnameOverride | string | `""` |  |
| image.pullPolicy | string | `"IfNotPresent"` |  |
| image.repository | string | `"hotio/qbittorrent"` |  |
| image.tag | string | `""` |  |
| ingress.annotations | object | `{}` |  |
| ingress.className | string | `"nginx"` |  |
| ingress.enabled | bool | `false` |  |
| ingress.hosts[0].host | string | `"chart-example.local"` |  |
| ingress.hosts[0].paths[0].path | string | `"/"` |  |
| ingress.hosts[0].paths[0].pathType | string | `"ImplementationSpecific"` |  |
| ingress.tls | list | `[]` |  |
| nameOverride | string | `""` |  |
| persistence.config.accessMode | string | `"ReadWriteOnce"` |  |
| persistence.config.enabled | bool | `false` |  |
| persistence.config.size | string | `"1Gi"` |  |
| persistence.data.accessMode | string | `"ReadWriteOnce"` |  |
| persistence.data.enabled | bool | `false` |  |
| persistence.data.size | string | `"500Gi"` |  |
| replicaCount | int | `1` |  |
| resources | object | `{}` |  |
| service.port | int | `8080` |  |
| service.type | string | `"ClusterIP"` |  |
| vpn.config | string | `""` |  |
| vpn.enabled | bool | `false` |  |
| vpn.existingKeys.passwordKey | string | `""` |  |
| vpn.existingKeys.usernameKey | string | `""` |  |
| vpn.existingSecret | string | `""` |  |
| vpn.provider | string | `"pia"` |  |

----------------------------------------------
Autogenerated from chart metadata using [helm-docs v1.14.2](https://github.com/norwoodj/helm-docs/releases/v1.14.2)
